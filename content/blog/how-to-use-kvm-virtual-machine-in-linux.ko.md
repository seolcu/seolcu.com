---
title: "리눅스에서 KVM 가상머신 사용하기"
date: 2023-12-31T11:33:14+09:00
draft: false
tags: ["Linux", "Virtual Machine", "KVM"]
cover:
  image: "/cover/kvm.png"
  alt: "KVM logo"
  caption: ""
---

리눅스 사용자라면, 윈도우를 사용해야 하는 상황에 직면했을 때가 있을 것입니다.
또는, 컴퓨터에 설치하지 않고 다른 리눅스 배포판을 테스트하고 싶을 수도 있습니다.
이런 경우, **가상머신**을 사용할 수 있습니다.

# 가상머신이란?

가상머신은 컴퓨터 위에서 돌아가는 가상의 컴퓨터입니다.
컴퓨터를 에뮬레이트하는 소프트웨어로, 운영체제를 설치하고 실제 컴퓨터처럼 사용할 수 있습니다.
여러 개의 가상머신을 안전하게 만들어서 사용할 수 있고, 필요할 때마다 삭제할 수 있습니다.

# 가상머신을 어떻게 사용하나요?

리눅스에서 가상머신을 사용하려면 두 가지가 필요합니다.

- **하이퍼바이저**: 가상머신을 돌리는 엔진입니다.
- **클라이언트**: 하이퍼바이저에 접속해서 가상머신을 사용하는 프로그램입니다.

이 글에서는 하이퍼바이저로 **KVM**을, 클라이언트로 **GNOME Boxes**나 **virt-manager**를 사용할 것입니다.

# 시작하기

## 1. BIOS에서 가상화 기능 활성화하기

KVM을 사용하기 전에, BIOS에서 가상화 기능을 활성화해야 합니다.
가상화 기능의 위치는 제조사마다 다르지만, CPU나 보안 섹션에 위치해 있습니다.

- 인텔 CPU의 경우, **Intel Virtualization Technology** 또는 **Intel VT**라고 부릅니다. 활성화해야 합니다.
- AMD CPU의 경우, **AMD Virtualization** 또는 **AMD-V**라고 부릅니다. 활성화해야 합니다.

## 2. 가상머신 클라이언트 설치하기

KVM은 이미 리눅스 커널에 내장되어 있기 때문에, 클라이언트만 설치하면 됩니다.

초보자라면, **GNOME Boxes**를 추천합니다. 설정이나 사용법이 매우 간단합니다.
고급 사용자이고 윈도우 11을 사용할 예정이라면, **virt-manager**를 추천합니다. 많은 기능을 제공합니다.

### 2-1. GNOME Boxes

GNOME Boxes는 리눅스용 간단한 가상머신 클라이언트입니다.
설정이나 사용법이 매우 간단하지만, 기능이 부족하기 때문에 TPM 2.0과 Secure Boot 때문에 **윈도우 11을 설치하기 어렵습니다.**

패키지 매니저에서 설치할 수 있습니다. 만약 패키지 매니저에 없다면, [Flathub](https://flathub.org/apps/details/org.gnome.Boxes)에서 설치할 수 있습니다. 하지만 USB 통과 기능 등의 기능이 없습니다.

데비안 기반 배포판을 사용한다면, 다음 명령어로 설치할 수 있습니다.

```bash
sudo apt install gnome-boxes
```

설치가 완료되었습니다! 이제 KVM을 사용할 수 있습니다.

### 2-2. virt-manager

virt-manager는 리눅스용 강력한 가상머신 클라이언트입니다.
설정이나 사용법이 조금 복잡하지만, 많은 기능을 제공하기 때문에 **윈도우 11을 설치할 수 있습니다.**

패키지 매니저에서 설치할 수 있습니다.

데비안 기반 배포판을 사용한다면, 다음 명령어로 설치할 수 있습니다.

```bash
sudo apt install virt-manager
```

이제 libvirtd 서비스를 활성화해야 합니다.

```bash
sudo systemctl enable --now libvirtd
```

또한, libvirt 그룹에 사용자를 추가해야 합니다.

```bash
sudo usermod -a -G libvirt $(whoami)
```

마지막으로, 네트워킹을 위해 가상 네트워크(NAT)를 생성하고 자동 시작하도록 설정해야 합니다.

```bash
sudo virsh net-autostart default
```

> 📘
>
> 또는, virt-manager -> QEMU/KVM 우클릭 -> 상세정보 -> 자동연결에 체크

설치가 완료되었습니다! 이제 KVM을 사용할 수 있습니다.

질문이 있으시다면, 댓글을 달아주세요.
